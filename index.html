import React, { useEffect, useState } from "react";

// WiliamoSite.jsx
// - Convertit la page HTML en composant React valide
// - Évite les problèmes de SSR / sandbox en ne rendant l'iframe Spotify que côté client
// - Fournit un fallback (bouton ouvrant l'album Spotify dans un nouvel onglet)
// - Styles scoped au composant (balise <style> injectée) — facile à extraire dans un CSS séparé
// - Pas de logo Spotify dans le footer (conforme à ta demande)

export default function WiliamoSite() {
  const [mounted, setMounted] = useState(false);

  useEffect(() => {
    // N'afficher l'iframe qu'après le montage client : évite les erreurs dans les environnements
    // qui ne supportent pas les iframes ou qui font un rendu côté serveur.
    setMounted(true);
  }, []);

  const spotifyEmbedSrc = "https://open.spotify.com/embed/album/61iNLMtGLjB90V7X19oiYx?utm_source=generator";
  const spotifyAlbumUrl = "https://open.spotify.com/album/61iNLMtGLjB90V7X19oiYx";

  return (
    <div className="wiliamo-root">
      <style>{`
        .wiliamo-root { min-height:100vh; display:flex; flex-direction:column; align-items:center; font-family: Poppins, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; color:#fff; background: linear-gradient(135deg,#0f0f0f,#1c1c1c); }
        header { text-align:center; padding:2rem 1rem; }
        header h1 { font-size:3rem; margin:0; background: linear-gradient(90deg,#ff4ecd,#4efcff); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }
        header h2 { margin:0.5rem 0 0; font-weight:400; color:#ccc; }
        .player { margin:2rem auto; width:90%; max-width:600px; box-shadow:0 8px 20px rgba(0,0,0,0.6); border-radius:16px; overflow:hidden; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); }
        .player .iframe { width:100%; height:380px; border:none; display:block; }
        .player .fallback { padding:2rem; display:flex; align-items:center; justify-content:center; gap:1rem; }
        .btn { display:inline-block; background:linear-gradient(90deg,#ff4ecd,#4efcff); color:#0b0b0b; padding:0.6rem 1rem; border-radius:10px; text-decoration:none; font-weight:600; }
        footer { margin-top:auto; padding:1.5rem; text-align:center; font-size:0.9rem; color:#aaa; width:100%; }
        a.mail { color:#4efcff; text-decoration:none; }
        @media (max-width:480px){ header h1{font-size:2rem;} .player .iframe{height:260px;} }
      `}</style>

      <header>
        <h1>Wiliamo</h1>
        <h2>Premier single : « A deux en 2070 »</h2>
      </header>

      <main style={{ width: "100%", display: "flex", justifyContent: "center" }}>
        <div className="player" role="region" aria-label="Lecteur Spotify - A deux en 2070">
          {mounted ? (
            // L'iframe n'est rendue que côté client pour éviter les erreurs dans les environnements
            // de rendu serveur / sandbox qui peuvent provoquer des erreurs non intuitives.
            <iframe
              className="iframe"
              title="Spotify - A deux en 2070"
              src={spotifyEmbedSrc}
              allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
              loading="lazy"
            />
          ) : (
            // Fallback pendant le rendu serveur / preview : bouton ouvrant l'album dans un nouvel onglet
            <div className="fallback">
              <a className="btn" href={spotifyAlbumUrl} target="_blank" rel="noopener noreferrer">
                Ouvrir l'album sur Spotify
              </a>
            </div>
          )}
        </div>
      </main>

      <footer>
        <p>© {new Date().getFullYear()} Wiliamo</p>
        <p>
          Contact : <a className="mail" href="mailto:wiwi.trouve@gmail.com">wiwi.trouve@gmail.com</a>
        </p>
      </footer>

      {/* Tests manuels recommandés (à lire) :
          1) Démarrer le projet React localement (npm start / vite) et vérifier que l'iframe s'affiche dans le navigateur.
          2) Vérifier le fallback : dans un aperçu côté serveur (ou désactiver JS), la page doit afficher un bouton "Ouvrir l'album sur Spotify" au lieu de planter.
          3) Ouvrir la console navigateur pour vérifier qu'aucune erreur JS n'apparaît au chargement.
          4) Si l'iframe ne se charge pas (politique CORS / sandbox du navigateur), l'album doit toujours être accessible via le bouton.
      */}
    </div>
  );
}
